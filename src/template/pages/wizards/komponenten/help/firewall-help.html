<div class="tooltip-definitions" style="display: none;">
    <div data-tooltip-id="firewall-name">
        <h2>Firewall Name</h2>
        <p>Ein eindeutiger Name für Ihre Firewall.</p>
        <div>
            <h3>Was ist eine Firewall?</h3>
            Ein Sicherheitssystem, das Netzwerk-Traffic kontrolliert und unerwünschten Zugriff blockiert - wie ein "Türsteher" für Ihr Netzwerk.
        </div>
        <div>
            <h3>Warum Firewalls essentiell sind:</h3>
            <ul>
                <li><strong>Schutz vor Angriffen:</strong> Blockiert Hacker und Malware</li>
                <li><strong>Zugangskontrolle:</strong> Nur erlaubter Traffic kommt durch</li>
                <li><strong>Netzwerk-Segmentierung:</strong> Trennt verschiedene Bereiche</li>
                <li><strong>Compliance:</strong> Gesetzliche Anforderung (DSGVO, KRITIS)</li>
            </ul>
        </div>
        <div>
            <h3>Namens-Beispiele:</h3>
            <ul>
                <li>"FW-DMZ-01" - Firewall für DMZ, Nummer 1</li>
                <li>"Perimeter-Firewall" - Außen-Firewall (Internet-Grenze)</li>
                <li>"FW-Internal-Segmentation" - Interne Trennung</li>
                <li>"Datacenter-FW-Palo-Alto" - Datacenter Firewall</li>
            </ul>
        </div>
        <em>Ohne Firewall = offenes Tor für Angreifer!</em>
    </div>

    <div data-tooltip-id="firewall-type">
        <h2>Typ / Hersteller</h2>
        <p>Welche Firewall-Lösung wird verwendet?</p>
        <div>
            <h3>Firewall-Kategorien:</h3>
            <ul>
                <li><strong>Enterprise Firewalls:</strong>
                    <ul>
                        <li><strong>Palo Alto Networks:</strong> Premium NGFW, sehr leistungsstark, teuer</li>
                        <li><strong>Fortinet FortiGate:</strong> Preis-Leistungs-Sieger, weit verbreitet</li>
                        <li><strong>Check Point:</strong> Traditioneller Marktführer, Enterprise-fokussiert</li>
                        <li><strong>Cisco Firepower:</strong> Integration mit Cisco-Infrastruktur</li>
                    </ul>
                </li>
                <li><strong>Mittelstand:</strong>
                    <ul>
                        <li><strong>Sophos XG/XGS:</strong> Einfache Verwaltung, gut für KMU</li>
                        <li><strong>WatchGuard:</strong> Solide Mittelstands-Lösung</li>
                        <li><strong>Juniper SRX:</strong> Enterprise, Carrier-Grade</li>
                    </ul>
                </li>
                <li><strong>Open Source:</strong>
                    <ul>
                        <li><strong>pfSense:</strong> Sehr beliebt, kostenlos, BSD-basiert</li>
                        <li><strong>OPNsense:</strong> Fork von pfSense, modernere UI</li>
                    </ul>
                </li>
                <li><strong>Cloud:</strong>
                    <ul>
                        <li><strong>Azure Firewall:</strong> Native Azure-Integration</li>
                        <li><strong>AWS Network Firewall:</strong> Native AWS-Integration</li>
                    </ul>
                </li>
            </ul>
        </div>
        <div>
            <h3>NGFW = Next-Generation Firewall:</h3>
            Moderne Firewalls mit Deep Packet Inspection, Application Control, IPS, etc.
        </div>
        <em>Trend: Von traditionellen zu Next-Gen Firewalls (NGFW)</em>
    </div>

    <div data-tooltip-id="firewall-model">
        <h2>Modell / Version</h2>
        <p>Das spezifische Firewall-Modell und die Software-Version.</p>
        <div>
            <h3>Warum wichtig?</h3>
            <ul>
                <li>Performance-Kapazität (Durchsatz in Gbps)</li>
                <li>Anzahl gleichzeitiger Sessions</li>
                <li>Verfügbare Features</li>
                <li>Support-Ende (End of Life)</li>
            </ul>
        </div>
        <div>
            <h3>Beispiele:</h3>
            <ul>
                <li>"PA-3220" - Palo Alto Modell</li>
                <li>"FortiGate 200F, v7.4" - Fortinet mit Version</li>
                <li>"pfSense 2.7.2" - Open Source Version</li>
            </ul>
        </div>
        <div>
            <h3>Performance-Klassen:</h3>
            <ul>
                <li>Small Office: 100-500 Mbps Throughput</li>
                <li>SMB: 1-5 Gbps</li>
                <li>Enterprise: 10-100 Gbps</li>
                <li>Carrier: 100+ Gbps</li>
            </ul>
        </div>
        <em>Firewall muss dimensioniert sein für Ihre Bandbreite!</em>
    </div>

    <div data-tooltip-id="firewall-serial">
        <h2>Seriennummer</h2>
        <p>Die eindeutige Seriennummer der Firewall-Appliance.</p>
        <div>
            <h3>Wofür wichtig:</h3>
            <ul>
                <li>Lizenz-Verwaltung (an Seriennummer gebunden)</li>
                <li>Support-Anfragen</li>
                <li>Garantie-Nachweis</li>
                <li>RMA (Return Merchandise Authorization)</li>
            </ul>
        </div>
        <em>Bei Hardware-Ausfall: Seriennummer wird für Ersatz benötigt</em>
    </div>

    <div data-tooltip-id="firewall-mgmt-ip">
        <h2>Management IP</h2>
        <p>Die IP-Adresse für die Administration der Firewall.</p>
        <div>
            <h3>Was ist Management IP?</h3>
            Eine separate IP nur für Admin-Zugriff zur Firewall-Konfiguration.
        </div>
        <div>
            <h3>Best Practices:</h3>
            <ul>
                <li>Separates Management-VLAN</li>
                <li>Nur aus Admin-Netz erreichbar</li>
                <li>Niemals von Internet erreichbar!</li>
                <li>Multi-Faktor-Authentifizierung aktivieren</li>
            </ul>
        </div>
        <div>
            <h3>Typisches Setup:</h3>
            <ul>
                <li>Management: 192.168.10.1 (Admin-Netz)</li>
                <li>External: 203.0.113.1 (Public IP)</li>
                <li>Internal: 10.0.0.1 (LAN)</li>
            </ul>
        </div>
        <em>Management-Zugriff muss maximal geschützt sein - Kompromittierung = Game Over!</em>
    </div>

    <div data-tooltip-id="firewall-location">
        <h2>Standort / Zone</h2>
        <p>Wo ist die Firewall platziert in der Netzwerk-Architektur?</p>
        <div>
            <h3>Typische Positionen:</h3>
            <ul>
                <li><strong>Perimeter:</strong> Zwischen Internet und internem Netz (Außengrenze)</li>
                <li><strong>DMZ:</strong> Schützt DMZ-Zone (öffentliche Server)</li>
                <li><strong>Internal:</strong> Zwischen internen Netzsegmenten</li>
                <li><strong>Datacenter:</strong> Vor Servern im Rechenzentrum</li>
            </ul>
        </div>
        <div>
            <h3>Beispiel-Architektur:</h3>
            <ul>
                <li>Internet → Perimeter-FW → DMZ-FW → Interne Server</li>
            </ul>
        </div>
        <em>Defense in Depth: Mehrere Firewall-Ebenen = besserer Schutz</em>
    </div>

    <div data-tooltip-id="firewall-function">
        <h2>Funktion</h2>
        <p>Welche Haupt-Rolle hat diese Firewall?</p>
        <div>
            <h3>Funktionen erklärt:</h3>
            <ul>
                <li><strong>Perimeter Firewall:</strong>
                    <ul>
                        <li>Erste Verteidigungslinie</li>
                        <li>Zwischen Internet und internem Netz</li>
                        <li>Blockiert die meisten Angriffe</li>
                        <li><em>Kritischste Firewall!</em></li>
                    </ul>
                </li>
                <li><strong>Internal Segmentation:</strong>
                    <ul>
                        <li>Trennt interne Netze (Micro-Segmentation)</li>
                        <li>Z.B. Trennung von Verwaltung und Produktion</li>
                        <li>Lateral Movement Prevention</li>
                    </ul>
                </li>
                <li><strong>DMZ Firewall:</strong>
                    <ul>
                        <li>Schützt DMZ-Zone</li>
                        <li>Zwischen DMZ und internem Netz</li>
                        <li>Doppelter Schutz für öffentliche Server</li>
                    </ul>
                </li>
                <li><strong>Datacenter Firewall:</strong>
                    <ul>
                        <li>Vor kritischen Servern</li>
                        <li>East-West Traffic Kontrolle</li>
                        <li>Schützt Datenbank- und Applikations-Server</li>
                    </ul>
                </li>
                <li><strong>Next-Gen Firewall (NGFW):</strong>
                    <ul>
                        <li>Moderne Firewall mit Deep Inspection</li>
                        <li>Application-Aware</li>
                        <li>Integrierte IPS, Anti-Malware, URL-Filter</li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>

    <div data-tooltip-id="firewall-external-if">
        <h2>Externe Interface / IP</h2>
        <p>Das Interface zur Außenwelt (Internet oder externes Netz).</p>
        <div>
            <h3>Was ist External Interface?</h3>
            Der "öffentliche" Port der Firewall - meist mit Public IP.
        </div>
        <div>
            <h3>Typisch:</h3>
            <ul>
                <li>Interface-Name: WAN, External, Outside, eth0</li>
                <li>IP: Public IP vom Provider (z.B. 203.0.113.1)</li>
                <li>Security Level: Untrusted (niedrigste Vertrauensstufe)</li>
            </ul>
        </div>
        <em>External Interface ist dem Internet ausgesetzt - maximal härten!</em>
    </div>

    <div data-tooltip-id="firewall-internal-if">
        <h2>Interne Interface / IP</h2>
        <p>Das Interface zum internen Netzwerk (LAN).</p>
        <div>
            <h3>Was ist Internal Interface?</h3>
            Der "private" Port der Firewall - zu Ihrem internen Netz.
        </div>
        <div>
            <h3>Typisch:</h3>
            <ul>
                <li>Interface-Name: LAN, Internal, Inside, eth1</li>
                <li>IP: Private IP (z.B. 10.0.0.1, 192.168.1.1)</li>
                <li>Security Level: Trusted (höchste Vertrauensstufe)</li>
            </ul>
        </div>
        <div>
            <h3>Meist auch:</h3>
            Default Gateway für interne Clients
        </div>
    </div>

    <div data-tooltip-id="firewall-dmz-if">
        <h2>DMZ Interface / IP</h2>
        <p>Das Interface zur DMZ (Demilitarized Zone).</p>
        <div>
            <h3>Was ist DMZ?</h3>
            Ein "neutraler" Bereich zwischen Internet und internem Netz für öffentliche Server (Webserver, Mail, etc.).
        </div>
        <div>
            <h3>Warum DMZ?</h3>
            <ul>
                <li>Öffentliche Server müssen vom Internet erreichbar sein</li>
                <li>Aber: Wenn kompromittiert, soll internes Netz geschützt bleiben</li>
                <li>DMZ = Pufferzone</li>
            </ul>
        </div>
        <div>
            <h3>Typisch:</h3>
            <ul>
                <li>Interface-Name: DMZ, eth2</li>
                <li>IP: 172.16.0.1</li>
                <li>Security Level: Medium</li>
            </ul>
        </div>
        <div>
            <h3>Firewall-Regeln:</h3>
            <ul>
                <li>Internet → DMZ: Nur spezifische Ports (80, 443)</li>
                <li>DMZ → Internal: Blockiert (oder sehr restriktiv)</li>
                <li>Internal → DMZ: Erlaubt (Management)</li>
            </ul>
        </div>
    </div>

    <div data-tooltip-id="firewall-other-zones">
        <h2>Weitere Zonen</h2>
        <p>Zusätzliche Netzwerk-Zonen/Segmente.</p>
        <div>
            <h3>Typische zusätzliche Zonen:</h3>
            <ul>
                <li><strong>Guest:</strong> WLAN für Besucher (stark eingeschränkt)</li>
                <li><strong>Management:</strong> Für Admin-Zugriff auf Infrastruktur</li>
                <li><strong>VPN:</strong> Für VPN-Clients (Remote-Mitarbeiter)</li>
                <li><strong>IoT:</strong> Für IoT-Geräte (medizinische Geräte)</li>
                <li><strong>Voice:</strong> Für VoIP-Telefonie</li>
                <li><strong>Backup:</strong> Dediziertes Backup-Netz</li>
            </ul>
        </div>
        <em>Mehr Zonen = granularere Kontrolle = bessere Sicherheit</em>
    </div>

    <div data-tooltip-id="firewall-ips">
        <h2>IPS/IDS</h2>
        <p>Intrusion Prevention/Detection System - erkennt und blockiert Angriffe.</p>
        <div>
            <h3>IDS vs IPS - Was ist der Unterschied?</h3>
            <ul>
                <li><strong>IDS (Detection):</strong> Erkennt Angriffe und alarmiert - blockiert aber NICHT</li>
                <li><strong>IPS (Prevention):</strong> Erkennt UND blockiert Angriffe automatisch</li>
            </ul>
        </div>
        <div>
            <h3>Modi:</h3>
            <ul>
                <li><strong>Aktiviert (IPS):</strong>
                    <ul>
                        <li>Angriffe werden geblockt</li>
                        <li>Schutz in Echtzeit</li>
                        <li>Kann False Positives verursachen (legitimer Traffic blockiert)</li>
                        <li><em>Empfohlen für Produktion!</em></li>
                    </ul>
                </li>
                <li><strong>IDS Only (Detection):</strong>
                    <ul>
                        <li>Nur Warnung, kein Block</li>
                        <li>Für Testphase oder Tuning</li>
                        <li>Weniger Risiko für False Positives</li>
                    </ul>
                </li>
                <li><strong>Nicht aktiviert:</strong> Kein Angriffsschutz (nicht empfohlen!)</li>
            </ul>
        </div>
        <div>
            <h3>Was IPS erkennt:</h3>
            <ul>
                <li>Exploit-Versuche (z.B. SQL Injection)</li>
                <li>Port-Scans</li>
                <li>Malware-Signaturen</li>
                <li>DoS/DDoS-Angriffe</li>
                <li>Anomalien im Traffic</li>
            </ul>
        </div>
        <em>IPS ist essentiell - aber muss getuned werden (False Positives minimieren)</em>
    </div>

    <div data-tooltip-id="firewall-appcontrol">
        <h2>Application Control</h2>
        <p>Kontrolle auf Anwendungs-Ebene (nicht nur Ports).</p>
        <div>
            <h3>Was ist Application Control?</h3>
            Firewall erkennt WELCHE Anwendung kommuniziert - nicht nur Port/IP.
        </div>
        <div>
            <h3>Traditionelle Firewall:</h3>
            Erlaubt Port 443 (HTTPS) - ALLE Apps über 443 erlaubt
        </div>
        <div>
            <h3>Application Control:</h3>
            Erlaubt Port 443 NUR für bestimmte Apps (z.B. nur Outlook Web Access, nicht Facebook)
        </div>
        <div>
            <h3>Beispiel-Szenarien:</h3>
            <ul>
                <li>Erlaube nur Office 365, blockiere andere Cloud-Apps</li>
                <li>Erlaube Remote Desktop nur für IT-Team</li>
                <li>Blockiere File-Sharing (Dropbox, WeTransfer)</li>
                <li>Blockiere Tor, Proxies, Anonymizer</li>
            </ul>
        </div>
        <div>
            <h3>Vorteile:</h3>
            <ul>
                <li>Granulare Kontrolle (nicht nur "Port offen/zu")</li>
                <li>Blockiert unerwünschte Apps trotz offener Ports</li>
                <li>Verhindert Tunnel und Umgehungen</li>
            </ul>
        </div>
        <em>Application Control = Next-Gen Feature - sehr mächtig!</em>
    </div>

    <div data-tooltip-id="firewall-urlfilter">
        <h2>URL Filtering</h2>
        <p>Blockiert Zugriff auf bestimmte Websites/Kategorien.</p>
        <div>
            <h3>Was ist URL Filtering?</h3>
            Firewall prüft aufgerufene URLs und blockiert nach Kategorien oder Blacklist.
        </div>
        <div>
            <h3>Typische blockierte Kategorien:</h3>
            <ul>
                <li>Malware & Phishing</li>
                <li>Adult Content</li>
                <li>Social Media (optional)</li>
                <li>Streaming (optional)</li>
                <li>File Sharing</li>
                <li>Gambling</li>
                <li>Anonymizer / VPN</li>
            </ul>
        </div>
        <div>
            <h3>Use Cases:</h3>
            <ul>
                <li><strong>Sicherheit:</strong> Blockiere bekannte Malware-Sites</li>
                <li><strong>Compliance:</strong> Verhindern Download illegaler Inhalte</li>
                <li><strong>Produktivität:</strong> Blockiere Zeitfresser (optional)</li>
            </ul>
        </div>
        <div>
            <h3>Datenbank-Update:</h3>
            URL-Filter braucht aktuelle Kategorien-Datenbank (Subscription)
        </div>
        <em>Im Healthcare: URL-Filter hilft gegen Phishing (größtes Einfallstor!)</em>
    </div>

    <div data-tooltip-id="firewall-antimalware">
        <h2>Anti-Malware / Virus Scan</h2>
        <p>Scannt Traffic auf Malware und Viren.</p>
        <div>
            <h3>Was macht Anti-Malware?</h3>
            Firewall scannt durchlaufende Dateien und E-Mails auf Schadsoftware.
        </div>
        <div>
            <h3>Scan-Typen:</h3>
            <ul>
                <li><strong>HTTP/HTTPS:</strong> Downloads via Browser</li>
                <li><strong>FTP:</strong> Datei-Transfers</li>
                <li><strong>SMTP/POP3:</strong> E-Mail-Anhänge</li>
                <li><strong>SMB:</strong> File-Share-Zugriffe</li>
            </ul>
        </div>
        <div>
            <h3>Erkennungs-Methoden:</h3>
            <ul>
                <li>Signatur-basiert (bekannte Malware)</li>
                <li>Heuristik (verdächtiges Verhalten)</li>
                <li>Sandboxing (Datei in isolierter Umgebung ausführen)</li>
                <li>Cloud-basiert (Reputation-Check)</li>
            </ul>
        </div>
        <div>
            <h3>Performance-Impact:</h3>
            Scanning kostet Ressourcen - kann Traffic verlangsamen
        </div>
        <em>Zusätzlicher Schutz zur Endpoint-Security - Defense in Depth!</em>
    </div>

    <div data-tooltip-id="firewall-ssl-inspection">
        <h2>SSL/TLS Inspection</h2>
        <p>Entschlüsselt HTTPS-Traffic zur Inspektion.</p>
        <div>
            <h3>Das Problem:</h3>
            80%+ des Traffics ist verschlüsselt (HTTPS) - Firewall kann Inhalt nicht sehen!
        </div>
        <div>
            <h3>Was ist SSL Inspection?</h3>
            Firewall agiert als Man-in-the-Middle:
            <ol>
                <li>Entschlüsselt HTTPS-Traffic</li>
                <li>Inspiziert Inhalt (Malware? Verbotene Seite?)</li>
                <li>Verschlüsselt wieder und leitet weiter</li>
            </ol>
        </div>
        <div>
            <h3>Modi:</h3>
            <ul>
                <li><strong>Full Inspection:</strong>
                    <ul>
                        <li>Alle HTTPS-Verbindungen werden entschlüsselt</li>
                        <li>Maximale Sicherheit</li>
                        <li>Hoher Performance-Aufwand</li>
                    </ul>
                </li>
                <li><strong>Partial (Outbound only):</strong>
                    <ul>
                        <li>Nur ausgehende Verbindungen</li>
                        <li>Eingehend (z.B. zu Webserver) nicht</li>
                        <li>Guter Kompromiss</li>
                    </ul>
                </li>
                <li><strong>Nicht aktiviert:</strong> Kein Blick in HTTPS (Malware kann sich verstecken)</li>
            </ul>
        </div>
        <div>
            <h3>Voraussetzung:</h3>
            Firewall-CA-Zertifikat muss auf Clients installiert sein (sonst Zertifikatsfehler)
        </div>
        <div>
            <h3>Ausnahmen:</h3>
            Banking, Gesundheits-Apps oft ausgenommen (Privacy)
        </div>
        <em>SSL Inspection ist kontrovers (Privacy) aber wichtig für Security</em>
    </div>

    <div data-tooltip-id="firewall-ddos">
        <h2>DDoS Protection</h2>
        <p>Schutz vor Distributed Denial of Service Angriffen.</p>
        <div>
            <h3>Was ist DDoS?</h3>
            Angreifer überlasten System mit Traffic von tausenden kompromittierten Geräten.
        </div>
        <div>
            <h3>DDoS-Typen:</h3>
            <ul>
                <li><strong>Volumetric:</strong> Einfach massive Traffic-Menge (überlastet Bandbreite)</li>
                <li><strong>Protocol:</strong> Ausnutzung von Protokoll-Schwächen (SYN Flood)</li>
                <li><strong>Application-Layer:</strong> Gezielte Angriffe auf Anwendung (z.B. HTTP Flood)</li>
            </ul>
        </div>
        <div>
            <h3>Firewall DDoS-Schutz:</h3>
            <ul>
                <li>Rate Limiting (Max. Requests pro IP)</li>
                <li>SYN Cookies (Schutz vor SYN Flood)</li>
                <li>Geo-Blocking (Blockiere Traffic aus bestimmten Ländern)</li>
                <li>Blacklist bekannter Bot-Netze</li>
            </ul>
        </div>
        <div>
            <h3>Limitation:</h3>
            Bei sehr großen DDoS (100+ Gbps) reicht Firewall nicht - braucht Cloud-DDoS-Protection (Cloudflare, Akamai)
        </div>
        <em>DDoS-Angriffe nehmen zu - Schutz ist wichtig!</em>
    </div>

    <div data-tooltip-id="firewall-ha">
        <h2>High Availability / Clustering</h2>
        <p>Redundante Firewall-Konfiguration für Hochverfügbarkeit.</p>
        <div>
            <h3>Warum HA wichtig:</h3>
            Firewall ist Single Point of Failure - fällt sie aus, ist komplettes Netz down!
        </div>
        <div>
            <h3>HA-Setup:</h3>
            Zwei (oder mehr) Firewalls arbeiten zusammen
        </div>
        <div>
            <h3>Vorteile:</h3>
            <ul>
                <li>Kein Ausfall bei Hardware-Defekt</li>
                <li>Wartung ohne Downtime (Rolling Updates)</li>
                <li>Automatisches Failover (Sekunden)</li>
            </ul>
        </div>
        <em>Für kritische Umgebungen: HA ist Pflicht!</em>
    </div>

    <div data-tooltip-id="firewall-ha-mode">
        <h2>HA-Modus</h2>
        <p>Wie arbeiten die Firewalls im HA-Verbund?</p>
        <div>
            <h3>Modi erklärt:</h3>
            <ul>
                <li><strong>Active-Passive:</strong>
                    <ul>
                        <li>Eine FW aktiv, andere im Standby</li>
                        <li>Bei Ausfall: Standby übernimmt (Failover)</li>
                        <li>Einfachste HA-Variante</li>
                        <li>Standby-FW wird nicht genutzt (Verschwendung)</li>
                        <li><em>Standard-HA-Modus</em></li>
                    </ul>
                </li>
                <li><strong>Active-Active:</strong>
                    <ul>
                        <li>Beide FWs verarbeiten Traffic</li>
                        <li>Last wird verteilt (Load Balancing)</li>
                        <li>Bessere Ressourcen-Nutzung</li>
                        <li>Komplexer zu konfigurieren</li>
                        <li>Bei Ausfall: Überlebende FW übernimmt alles</li>
                    </ul>
                </li>
                <li><strong>Full Mesh Cluster:</strong>
                    <ul>
                        <li>3+ Firewalls im Cluster</li>
                        <li>Sehr hohe Verfügbarkeit</li>
                        <li>Komplex und teuer</li>
                        <li>Für sehr kritische Umgebungen</li>
                    </ul>
                </li>
            </ul>
        </div>
        <div>
            <h3>Failover-Zeit:</h3>
            <ul>
                <li>Active-Passive: 1-10 Sekunden</li>
                <li>Active-Active: Nahezu transparent (< 1 Sekunde)</li>
            </ul>
        </div>
    </div>

    <div data-tooltip-id="firewall-partner">
        <h2>Partner/Standby Firewall</h2>
        <p>Die redundante Firewall im HA-Paar.</p>
        <div>
            <h3>Wichtig:</h3>
            <ul>
                <li>Identisches Modell wie primäre FW</li>
                <li>Gleiche Software-Version</li>
                <li>Konfiguration wird synchronisiert</li>
                <li>Dedizierte HA-Verbindung (Heartbeat)</li>
            </ul>
        </div>
        <div>
            <h3>Beispiel:</h3>
            <ul>
                <li>Primary: FW-DMZ-01</li>
                <li>Standby: FW-DMZ-02</li>
            </ul>
        </div>
        <em>Beide FWs müssen physisch getrennt sein (verschiedene Racks, Stromkreise)</em>
    </div>

    <div data-tooltip-id="firewall-log-level">
        <h2>Log Level</h2>
        <p>Wie detailliert werden Firewall-Aktivitäten protokolliert?</p>
        <div>
            <h3>Log-Level erklärt:</h3>
            <ul>
                <li><strong>All Traffic (Allow + Deny):</strong>
                    <ul>
                        <li>Jede Verbindung wird geloggt (erlaubt UND blockiert)</li>
                        <li>Maximale Transparenz</li>
                        <li>Sehr große Log-Dateien!</li>
                        <li>Performance-Impact bei hohem Traffic</li>
                        <li><em>Für Compliance oft erforderlich</em></li>
                    </ul>
                </li>
                <li><strong>Deny Only:</strong>
                    <ul>
                        <li>Nur blockierte Verbindungen</li>
                        <li>Weniger Logs, fokussiert auf Probleme</li>
                        <li>Guter Kompromiss</li>
                    </ul>
                </li>
                <li><strong>Security Events Only:</strong>
                    <ul>
                        <li>Nur Sicherheits-relevante Events (IPS, Malware)</li>
                        <li>Minimale Logs</li>
                        <li>Fokus auf Bedrohungen</li>
                    </ul>
                </li>
                <li><strong>Minimal:</strong>
                    <ul>
                        <li>Nur kritische Fehler und Admin-Aktionen</li>
                        <li>Nicht empfohlen (zu wenig Visibility)</li>
                    </ul>
                </li>
            </ul>
        </div>
        <div>
            <h3>Compliance:</h3>
            DSGVO und KRITIS verlangen oft "All Traffic" Logging
        </div>
        <em>Balance: Genug für Forensik, nicht zu viel für Storage/Performance</em>
    </div>

    <div data-tooltip-id="firewall-siem">
        <h2>SIEM Integration</h2>
        <p>Wohin werden Firewall-Logs gesendet?</p>
        <div>
            <h3>Warum SIEM wichtig:</h3>
            Firewall-Logs sind essentiell für Security-Monitoring!
        </div>
        <div>
            <h3>SIEM-Systeme:</h3>
            <ul>
                <li>Splunk - Marktführer</li>
                <li>QRadar - IBM</li>
                <li>Syslog-Server - Basic Logging</li>
                <li>Elastic Stack - Open Source</li>
                <li>Microsoft Sentinel - Cloud</li>
            </ul>
        </div>
        <div>
            <h3>Was SIEM macht:</h3>
            <ul>
                <li>Zentrale Log-Sammlung</li>
                <li>Korrelation über Systeme hinweg</li>
                <li>Angriffs-Erkennung</li>
                <li>Compliance-Reports</li>
            </ul>
        </div>
        <em>Firewall-Logs sollten IMMER zentral gesammelt werden!</em>
    </div>

    <div data-tooltip-id="firewall-log-retention">
        <h2>Log Retention (Tage)</h2>
        <p>Wie lange werden Logs aufbewahrt?</p>
        <div>
            <h3>Gesetzliche Anforderungen:</h3>
            <ul>
                <li><strong>DSGVO:</strong> 6-24 Monate (je nach Zweck)</li>
                <li><strong>KRITIS:</strong> Minimum 6 Monate</li>
                <li><strong>GoBD:</strong> 10 Jahre für steuerrelevante Daten</li>
            </ul>
        </div>
        <div>
            <h3>Typische Retention:</h3>
            <ul>
                <li><strong>90 Tage:</strong> Minimum für Troubleshooting</li>
                <li><strong>1 Jahr:</strong> Standard für Compliance</li>
                <li><strong>2+ Jahre:</strong> Bei sensiblen Daten (Patientendaten)</li>
            </ul>
        </div>
        <div>
            <h3>Storage-Planung:</h3>
            Firewall-Logs können GB/Tag erzeugen!
        </div>
        <em>Bei Sicherheitsvorfall: Alte Logs können entscheidend sein!</em>
    </div>

    <div data-tooltip-id="firewall-monitoring">
        <h2>Monitoring / Alerting</h2>
        <p>Wie wird die Firewall überwacht?</p>
        <div>
            <h3>Warum Monitoring kritisch:</h3>
            Firewall-Ausfall = komplettes Netz down!
        </div>
        <div>
            <h3>Monitoring-Methoden:</h3>
            <ul>
                <li><strong>SNMP:</strong> Standard Network Monitoring Protokoll</li>
                <li><strong>Prometheus:</strong> Modern, für Container-Umgebungen</li>
                <li><strong>Syslog:</strong> Log-basiertes Monitoring</li>
                <li><strong>E-Mail:</strong> Alerts bei kritischen Events</li>
                <li><strong>SMS:</strong> Für kritische Ausfälle (24/7)</li>
            </ul>
        </div>
        <div>
            <h3>Was überwachen:</h3>
            <ul>
                <li>HA-Status (beide FWs aktiv?)</li>
                <li>CPU/RAM-Auslastung</li>
                <li>Session-Count</li>
                <li>Interface-Status (Up/Down)</li>
                <li>Threat-Events (IPS-Alerts)</li>
                <li>VPN-Tunnels</li>
            </ul>
        </div>
        <em>Firewall-Monitoring muss 24/7 laufen!</em>
    </div>
    
    <div data-tooltip-id="firewall-notes">
        <h2>Notizen / Besonderheiten</h2>
        <p>Zusätzliche wichtige Informationen zur Firewall.</p>
        <div>
            <h3>Was dokumentieren:</h3>
            <ul>
                <li><strong>Change-Prozesse:</strong> Wer darf Firewall-Regeln ändern?</li>
                <li><strong>Besondere Konfigurationen:</strong> NAT-Regeln, VPN-Konfiguration</li>
                <li><strong>Bekannte Issues:</strong> Probleme und Workarounds</li>
                <li><strong>Wartungsfenster:</strong> Wann Updates durchführen?</li>
                <li><strong>Notfall-Kontakte:</strong> Vendor-Support, internes Team</li>
                <li><strong>Backup-Konfiguration:</strong> Wo sind Config-Backups?</li>
            </ul>
        </div>
        <div>
            <h3>Beispiel:</h3>
            "Change-Prozess: Alle Regel-Änderungen über Ticket-System. Backup täglich um 02:00 Uhr auf backup-server-01. VPN-Tunnel zu Zweigstelle Berlin (IPsec). Wartung: Jeden 2. Sonntag 03:00-05:00. Support: Fortinet TAC +1-xxx (24/7), intern: network-team@example.com. Config-Backup: /backup/firewall/configs/"
        </div>
        <em>Gute Firewall-Dokumentation ist Gold wert bei Notfällen!</em>
    </div>

    <div data-tooltip-id="firewall-management-url">
        <h2>Management-URL</h2>
        <p>Die vollständige URL zur Web-Management-Konsole der Firewall.</p>
        <div>
            <h3>Format:</h3>
            https://hostname-or-ip:port
        </div>
        <div>
            <h3>Typische URLs:</h3>
            <ul>
                <li><strong>Palo Alto:</strong> https://fw-dmz-01.example.com (Port 443)</li>
                <li><strong>Fortinet:</strong> https://192.168.10.1:443</li>
                <li><strong>Check Point:</strong> https://fw.example.com:4434</li>
                <li><strong>pfSense:</strong> https://192.168.1.1:443</li>
                <li><strong>Sophos:</strong> https://fw.example.com:4444</li>
            </ul>
        </div>
        <div>
            <h3>Sicherheit:</h3>
            <ul>
                <li>Immer HTTPS verwenden (nie HTTP!)</li>
                <li>Nur über Management-VLAN erreichbar</li>
                <li>Multi-Faktor-Authentifizierung aktivieren</li>
                <li>Niemals direkt aus dem Internet erreichbar</li>
                <li>VPN oder Jump-Host für Remote-Zugriff</li>
            </ul>
        </div>
        <div>
            <h3>Best Practice:</h3>
            Verwenden Sie DNS-Namen statt IP-Adressen (einfacher bei IP-Änderungen)
        </div>
        <em>Management-URL ist der zentrale Zugriffspunkt für alle Firewall-Konfigurationen!</em>
    </div>

    <div data-tooltip-id="firewall-rules">
        <h2>Firewall-Regeln</h2>
        <p>Die Sicherheitsrichtlinien, die den Traffic kontrollieren.</p>
        <div>
            <h3>Was sind Firewall-Regeln?</h3>
            Anweisungen, die festlegen, welcher Traffic erlaubt oder blockiert wird.
        </div>
        <div>
            <h3>Regel-Aufbau:</h3>
            <ul>
                <li><strong>Source:</strong> Woher kommt der Traffic? (IP, Netz, Zone)</li>
                <li><strong>Destination:</strong> Wohin geht er? (IP, Netz, Zone)</li>
                <li><strong>Service:</strong> Welcher Port/Protokoll? (HTTP, HTTPS, SSH, etc.)</li>
                <li><strong>Action:</strong> Allow oder Deny?</li>
                <li><strong>Logging:</strong> Wird die Verbindung geloggt?</li>
            </ul>
        </div>
        <div>
            <h3>Regel-Reihenfolge:</h3>
            <ul>
                <li>Regeln werden von oben nach unten abgearbeitet</li>
                <li>Erste passende Regel gewinnt</li>
                <li>Letzte Regel: "Implicit Deny" (alles andere blockieren)</li>
            </ul>
        </div>
        <div>
            <h3>Best Practices:</h3>
            <ul>
                <li><strong>Least Privilege:</strong> Nur das Nötigste erlauben</li>
                <li><strong>Spezifisch:</strong> Keine "Any-Any-Allow" Regeln</li>
                <li><strong>Dokumentiert:</strong> Jede Regel mit Kommentar (Warum? Für wen?)</li>
                <li><strong>Regelmäßig aufräumen:</strong> Alte/ungenutzte Regeln löschen</li>
                <li><strong>Change-Control:</strong> Änderungen nur über Ticket-System</li>
            </ul>
        </div>
        <div>
            <h3>Typische Standard-Regeln:</h3>
            <ul>
                <li>Internal → Internet: HTTP/HTTPS erlauben</li>
                <li>Internet → DMZ: Nur spezifische Ports (80, 443)</li>
                <li>DMZ → Internal: BLOCKIERT (oder sehr restriktiv)</li>
                <li>Management-VLAN → Firewall: SSH/HTTPS erlauben</li>
                <li>Alle anderen: DENY (Implicit Deny)</li>
            </ul>
        </div>
        <em>Firewall-Regeln sind das Herz der Firewall - falsche Regel = Sicherheitslücke!</em>
    </div>

    <div data-tooltip-id="firewall-nat">
        <h2>NAT (Network Address Translation)</h2>
        <p>Übersetzung von IP-Adressen für Internet-Zugriff.</p>
        <div>
            <h3>Was ist NAT?</h3>
            Private IPs (10.x, 192.168.x) können nicht direkt ins Internet - NAT übersetzt zu Public IP.
        </div>
        <div>
            <h3>NAT-Typen:</h3>
            <ul>
                <li><strong>Source NAT (SNAT) / PAT:</strong>
                    <ul>
                        <li>Viele private IPs → eine Public IP</li>
                        <li>Für ausgehenden Traffic (Clients → Internet)</li>
                        <li>Port-basierte Unterscheidung</li>
                        <li><em>Standard für Internet-Zugriff</em></li>
                    </ul>
                </li>
                <li><strong>Destination NAT (DNAT):</strong>
                    <ul>
                        <li>Public IP → Private IP</li>
                        <li>Für eingehenden Traffic (Internet → Server)</li>
                        <li>Port-Forwarding</li>
                        <li>Beispiel: Public 203.0.113.1:443 → DMZ 172.16.0.10:443</li>
                    </ul>
                </li>
                <li><strong>1:1 NAT:</strong>
                    <ul>
                        <li>Jede Private IP bekommt eigene Public IP</li>
                        <li>Für Server mit vielen Services</li>
                    </ul>
                </li>
            </ul>
        </div>
        <div>
            <h3>Häufige NAT-Szenarien:</h3>
            <ul>
                <li>Interne Clients ins Internet (SNAT)</li>
                <li>Webserver in DMZ von außen erreichbar (DNAT)</li>
                <li>VPN-Clients Zugriff auf interne Ressourcen (SNAT)</li>
            </ul>
        </div>
        <em>NAT ist essentiell - aber macht Troubleshooting komplexer!</em>
    </div>

    <div data-tooltip-id="firewall-vpn">
        <h2>VPN-Konfiguration</h2>
        <p>Verschlüsselte Tunnel für sichere Remote-Verbindungen.</p>
        <div>
            <h3>VPN-Typen:</h3>
            <ul>
                <li><strong>Site-to-Site VPN:</strong>
                    <ul>
                        <li>Verbindet zwei Standorte (z.B. Hauptsitz ↔ Zweigstelle)</li>
                        <li>IPsec-basiert</li>
                        <li>Permanent aktiv</li>
                        <li>Transparent für Benutzer</li>
                    </ul>
                </li>
                <li><strong>Remote Access VPN (Client-VPN):</strong>
                    <ul>
                        <li>Einzelne Benutzer von außen</li>
                        <li>SSL-VPN oder IPsec</li>
                        <li>On-Demand (bei Bedarf)</li>
                        <li>Für Home-Office, Dienstreisen</li>
                    </ul>
                </li>
            </ul>
        </div>
        <div>
            <h3>VPN-Protokolle:</h3>
            <ul>
                <li><strong>IPsec:</strong> Standard für Site-to-Site, sehr sicher</li>
                <li><strong>SSL-VPN:</strong> Browser-basiert, einfach für Enduser</li>
                <li><strong>WireGuard:</strong> Modern, sehr schnell, einfach</li>
            </ul>
        </div>
        <div>
            <h3>Sicherheit:</h3>
            <ul>
                <li>Starke Verschlüsselung (AES-256)</li>
                <li>Multi-Faktor-Authentifizierung für Remote-VPN</li>
                <li>Split-Tunneling vermeiden (aller Traffic durch VPN)</li>
                <li>Regelmäßige Credential-Rotation</li>
            </ul>
        </div>
        <em>VPN ist kritisch im Healthcare - sichere Fernzugriffe für Ärzte!</em>
    </div>

    <div data-tooltip-id="firewall-performance">
        <h2>Performance & Kapazität</h2>
        <p>Kann die Firewall den Traffic bewältigen?</p>
        <div>
            <h3>Performance-Metriken:</h3>
            <ul>
                <li><strong>Throughput:</strong>
                    <ul>
                        <li>Firewall-Durchsatz (Gbps)</li>
                        <li>Muss größer sein als Ihre Bandbreite</li>
                        <li>Mit IPS/Malware-Scan: 50-80% weniger!</li>
                        <li>Beispiel: 1 Gbps Internet → 2-4 Gbps FW nötig</li>
                    </ul>
                </li>
                <li><strong>Concurrent Sessions:</strong>
                    <ul>
                        <li>Gleichzeitige Verbindungen</li>
                        <li>Jeder Client = viele Sessions (100+)</li>
                        <li>Zu wenig = neue Verbindungen werden abgelehnt</li>
                    </ul>
                </li>
                <li><strong>New Sessions/Second:</strong>
                    <ul>
                        <li>Wie schnell können neue Verbindungen aufgebaut werden?</li>
                        <li>Wichtig bei vielen kurzen Verbindungen (Web-Browsing)</li>
                    </ul>
                </li>
                <li><strong>Latency:</strong>
                    <ul>
                        <li>Verzögerung durch Firewall (< 10ms ideal)</li>
                        <li>IPS/DPI erhöht Latency</li>
                    </ul>
                </li>
            </ul>
        </div>
        <div>
            <h3>Performance-Killer:</h3>
            <ul>
                <li>SSL Inspection (CPU-intensiv)</li>
                <li>Anti-Malware Scanning</li>
                <li>IPS mit vielen Signaturen</li>
                <li>Excessive Logging (All Traffic)</li>
            </ul>
        </div>
        <div>
            <h3>Monitoring:</h3>
            Regelmäßig CPU, RAM, Session-Count überwachen - Überlastung vor Kapazitätsgrenze erkennen
        </div>
        <em>Unterdimensionierte Firewall = Performance-Probleme für alle!</em>
    </div>

    <div data-tooltip-id="firewall-updates">
        <h2>Updates & Patches</h2>
        <p>Wie werden Firewall-Updates durchgeführt?</p>
        <div>
            <h3>Was muss aktualisiert werden:</h3>
            <ul>
                <li><strong>Firmware/OS:</strong> Basis-Software der Firewall</li>
                <li><strong>Threat Signatures:</strong> IPS/Anti-Malware Signaturen (täglich!)</li>
                <li><strong>URL-Filter DB:</strong> Kategorien-Datenbank</li>
                <li><strong>Application Signatures:</strong> App-Erkennungs-DB</li>
            </ul>
        </div>
        <div>
            <h3>Update-Frequenzen:</h3>
            <ul>
                <li><strong>Signaturen:</strong> Automatisch täglich (kritisch!)</li>
                <li><strong>Minor Firmware:</strong> Quartalsweise</li>
                <li><strong>Major Firmware:</strong> Jährlich (nach gründlichem Test)</li>
                <li><strong>Security Patches:</strong> Sofort (nach kurzer Test-Phase)</li>
            </ul>
        </div>
        <div>
            <h3>Update-Prozess:</h3>
            <ol>
                <li>Config-Backup erstellen</li>
                <li>Erst auf Standby-FW testen (HA)</li>
                <li>Bei Erfolg: Auf Primary FW</li>
                <li>Monitoring beobachten</li>
                <li>Rollback-Plan bereithalten</li>
            </ol>
        </div>
        <div>
            <h3>Wartungsfenster:</h3>
            Firmware-Updates erfordern meist Neustart - Wartungsfenster planen
        </div>
        <em>Veraltete Firewall = bekannte Sicherheitslücken = leichtes Ziel!</em>
    </div>

    <div data-tooltip-id="firewall-backup">
        <h2>Konfiguration-Backup</h2>
        <p>Regelmäßige Sicherung der Firewall-Konfiguration.</p>
        <div>
            <h3>Warum Backup kritisch:</h3>
            <ul>
                <li>Hardware-Ausfall → Schneller Rebuild</li>
                <li>Fehlkonfiguration → Rollback möglich</li>
                <li>Compliance → Nachweis von Änderungen</li>
                <li>Disaster Recovery</li>
            </ul>
        </div>
        <div>
            <h3>Was sichern:</h3>
            <ul>
                <li>Komplette Konfiguration (Rules, NAT, VPN, etc.)</li>
                <li>Zertifikate und Keys</li>
                <li>Custom-Scripts</li>
                <li>Dokumentation (Regel-Kommentare)</li>
            </ul>
        </div>
        <div>
            <h3>Backup-Strategien:</h3>
            <ul>
                <li><strong>Automatisch:</strong> Täglich via Script oder Backup-Software</li>
                <li><strong>Manuell:</strong> Vor/Nach jeder Änderung</li>
                <li><strong>Versionierung:</strong> Mehrere Backups aufbewahren (30 Tage)</li>
                <li><strong>Offsite:</strong> Backup auch außerhalb Rechenzentrum</li>
            </ul>
        </div>
        <div>
            <h3>Test:</h3>
            Regelmäßig testen, ob Restore funktioniert (mindestens jährlich)
        </div>
        <em>Ohne Config-Backup: Bei Ausfall stundenlange Neu-Konfiguration!</em>
    </div>

    <div data-tooltip-id="firewall-compliance">
        <h2>Compliance & Audit</h2>
        <p>Firewall-Anforderungen für Compliance.</p>
        <div>
            <h3>Relevante Standards:</h3>
            <ul>
                <li><strong>DSGVO:</strong>
                    <ul>
                        <li>Schutz personenbezogener Daten</li>
                        <li>Logging und Monitoring erforderlich</li>
                        <li>Dokumentation von Security-Maßnahmen</li>
                    </ul>
                </li>
                <li><strong>KRITIS (Kritische Infrastrukturen):</strong>
                    <ul>
                        <li>Erhöhte Anforderungen für Krankenhäuser</li>
                        <li>Stand der Technik erforderlich</li>
                        <li>Regelmäßige Penetrationstests</li>
                        <li>Incident-Response-Pläne</li>
                    </ul>
                </li>
                <li><strong>ISO 27001:</strong>
                    <ul>
                        <li>Firewall als technische Maßnahme</li>
                        <li>Dokumentation der Konfiguration</li>
                        <li>Change-Management</li>
                    </ul>
                </li>
            </ul>
        </div>
        <div>
            <h3>Audit-Anforderungen:</h3>
            <ul>
                <li>Dokumentation aller Firewall-Regeln (Zweck, Verantwortlicher)</li>
                <li>Change-Log (Wer hat wann was geändert?)</li>
                <li>Regelmäßige Rule-Reviews (mind. jährlich)</li>
                <li>Log-Retention gemäß Vorgaben (meist 1 Jahr)</li>
                <li>Regelmäßige Vulnerability-Scans</li>
            </ul>
        </div>
        <div>
            <h3>Best Practices:</h3>
            <ul>
                <li>4-Augen-Prinzip für kritische Regel-Änderungen</li>
                <li>Separation of Duties (Konfiguration ≠ Approval)</li>
                <li>Dokumentierte Firewall-Policy</li>
            </ul>
        </div>
        <em>Compliance ist nicht optional - Verstöße können teuer werden!</em>
    </div>

    <div data-tooltip-id="firewall-troubleshooting">
        <h2>Troubleshooting</h2>
        <p>Häufige Firewall-Probleme und Lösungen.</p>
        <div>
            <h3>Typische Probleme:</h3>
            <ul>
                <li><strong>Verbindung wird blockiert:</strong>
                    <ul>
                        <li>Check: Gibt es passende Allow-Regel?</li>
                        <li>Check: Regel-Reihenfolge (frühere Deny-Regel?)</li>
                        <li>Check: NAT korrekt konfiguriert?</li>
                        <li>Tool: Packet Capture auf Firewall</li>
                    </ul>
                </li>
                <li><strong>Performance-Probleme:</strong>
                    <ul>
                        <li>Check: CPU/RAM-Auslastung</li>
                        <li>Check: Session-Count nahe am Limit?</li>
                        <li>Check: Ist IPS/Malware-Scan zu aggressiv?</li>
                        <li>Check: Logging zu verbose (All Traffic)?</li>
                    </ul>
                </li>
                <li><strong>HA-Failover funktioniert nicht:</strong>
                    <ul>
                        <li>Check: HA-Heartbeat-Verbindung OK?</li>
                        <li>Check: Beide FWs gleiche Software-Version?</li>
                        <li>Check: Config-Sync aktiviert?</li>
                    </ul>
                </li>
                <li><strong>VPN-Tunnel fällt ab:</strong>
                    <ul>
                        <li>Check: Phase 1 & 2 Parameter identisch?</li>
                        <li>Check: NAT-Traversal aktiviert?</li>
                        <li>Check: Idle-Timeout zu kurz?</li>
                    </ul>
                </li>
            </ul>
        </div>
        <div>
            <h3>Troubleshooting-Tools:</h3>
            <ul>
                <li>Packet Capture (tcpdump auf Firewall)</li>
                <li>Policy Lookup (Test-Regel vor Aktivierung)</li>
                <li>Session Browser (aktive Verbindungen sehen)</li>
                <li>Logs (immer zuerst in Logs schauen!)</li>
            </ul>
        </div>
        <em>Bei Firewall-Problemen: Logs sind Ihr bester Freund!</em>
    </div>
</div>
